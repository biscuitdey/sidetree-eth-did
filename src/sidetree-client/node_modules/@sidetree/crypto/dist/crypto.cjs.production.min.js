"use strict";function r(r){return r&&"object"==typeof r&&"default"in r?r.default:r}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@transmute/did-key-ed25519"),e=require("@transmute/did-key-secp256k1"),n=require("bip39"),o=r(require("hdkey")),a=r(require("base64url")),i=r(require("canonicalize"));function u(r,t,e,n,o,a,i){try{var u=r[a](i),c=u.value}catch(r){return void e(r)}u.done?t(c):Promise.resolve(c).then(n,o)}function c(r){return function(){var t=this,e=arguments;return new Promise((function(n,o){var a=r.apply(t,e);function i(r){u(a,n,o,i,c,"next",r)}function c(r){u(a,n,o,i,c,"throw",r)}i(void 0)}))}}var s,f=(function(r){var t=function(r){var t=Object.prototype,e=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(r,t,e){return Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),r[t]}try{u({},"")}catch(r){u=function(r,t,e){return r[t]=e}}function c(r,t,e,n){var o=Object.create((t&&t.prototype instanceof p?t:p).prototype),a=new E(n||[]);return o._invoke=function(r,t,e){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(e.method=o,e.arg=a;;){var i=e.delegate;if(i){var u=x(i,e);if(u){if(u===f)continue;return u}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===n)throw n="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n="executing";var c=s(r,t,e);if("normal"===c.type){if(n=e.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(n="completed",e.method="throw",e.arg=c.arg)}}}(r,e,a),o}function s(r,t,e){try{return{type:"normal",arg:r.call(t,e)}}catch(r){return{type:"throw",arg:r}}}r.wrap=c;var f={};function p(){}function h(){}function l(){}var v={};v[o]=function(){return this};var d=Object.getPrototypeOf,y=d&&d(d(L([])));y&&y!==t&&e.call(y,o)&&(v=y);var m=l.prototype=p.prototype=Object.create(v);function w(r){["next","throw","return"].forEach((function(t){u(r,t,(function(r){return this._invoke(t,r)}))}))}function g(r,t){var n;this._invoke=function(o,a){function i(){return new t((function(n,i){!function n(o,a,i,u){var c=s(r[o],r,a);if("throw"!==c.type){var f=c.arg,p=f.value;return p&&"object"==typeof p&&e.call(p,"__await")?t.resolve(p.__await).then((function(r){n("next",r,i,u)}),(function(r){n("throw",r,i,u)})):t.resolve(p).then((function(r){f.value=r,i(f)}),(function(r){return n("throw",r,i,u)}))}u(c.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function x(r,t){var e=r.iterator[t.method];if(void 0===e){if(t.delegate=null,"throw"===t.method){if(r.iterator.return&&(t.method="return",t.arg=void 0,x(r,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=s(e,r.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var o=n.arg;return o?o.done?(t[r.resultName]=o.value,t.next=r.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function b(r){var t={tryLoc:r[0]};1 in r&&(t.catchLoc=r[1]),2 in r&&(t.finallyLoc=r[2],t.afterLoc=r[3]),this.tryEntries.push(t)}function k(r){var t=r.completion||{};t.type="normal",delete t.arg,r.completion=t}function E(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(b,this),this.reset(!0)}function L(r){if(r){var t=r[o];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var n=-1,a=function t(){for(;++n<r.length;)if(e.call(r,n))return t.value=r[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return h.prototype=m.constructor=l,l.constructor=h,h.displayName=u(l,i,"GeneratorFunction"),r.isGeneratorFunction=function(r){var t="function"==typeof r&&r.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,l):(r.__proto__=l,u(r,i,"GeneratorFunction")),r.prototype=Object.create(m),r},r.awrap=function(r){return{__await:r}},w(g.prototype),g.prototype[a]=function(){return this},r.AsyncIterator=g,r.async=function(t,e,n,o,a){void 0===a&&(a=Promise);var i=new g(c(t,e,n,o),a);return r.isGeneratorFunction(e)?i:i.next().then((function(r){return r.done?r.value:i.next()}))},w(m),u(m,i,"Generator"),m[o]=function(){return this},m.toString=function(){return"[object Generator]"},r.keys=function(r){var t=[];for(var e in r)t.push(e);return t.reverse(),function e(){for(;t.length;){var n=t.pop();if(n in r)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=L,E.prototype={constructor:E,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!r)for(var t in this)"t"===t.charAt(0)&&e.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var r=this.tryEntries[0].completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var t=this;function n(e,n){return i.type="throw",i.arg=r,t.next=e,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=e.call(a,"catchLoc"),c=e.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(r,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&e.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===r||"continue"===r)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=r,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(r,t){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&t&&(this.next=t),f},finish:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===r)return this.complete(e.completion,e.afterLoc),k(e),f}},catch:function(r){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===r){var n=e.completion;if("throw"===n.type){var o=n.arg;k(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(r,t,e){return this.delegate={iterator:L(r),resultName:t,nextLoc:e},"next"===this.method&&(this.arg=void 0),f}},r}(r.exports);try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}}(s={exports:{}}),s.exports),p=function(){var r=c(f.mark((function r(){return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.generateMnemonic();case 2:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),h={secp256k1:"ES256K",Ed25519:"EdDSA"},l=function(){var r=c(f.mark((function r(a,i,u){var c,s,p;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return void 0===u&&(u="Ed25519"),r.next=3,n.mnemonicToSeed(a);case 3:c=o.fromMasterSeed(r.sent),s=c.derive("m/44'/1'/0'/0/"+i),r.t0=u,r.next="secp256k1"===r.t0?10:"X25519"===r.t0?14:19;break;case 10:return r.next=12,e.Secp256k1KeyPair.generate({secureRandom:function(){return s._privateKey}});case 12:return p=r.sent,r.abrupt("break",23);case 14:return r.next=16,t.Ed25519KeyPair.generate({secureRandom:function(){return s._privateKey}});case 16:return p=(p=r.sent).toX25519KeyPair(!0),r.abrupt("break",23);case 19:return r.next=21,t.Ed25519KeyPair.generate({secureRandom:function(){return s._privateKey}});case 21:return p=r.sent,r.abrupt("break",23);case 23:return r.abrupt("return",p);case 24:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}(),v=function(){var r=c(f.mark((function r(n){var o,a;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.crv,r.next="Ed25519"===r.t0?3:"secp256k1"===r.t0?7:11;break;case 3:return r.next=5,t.Ed25519KeyPair.from({publicKeyJwk:n,privateKeyJwk:n});case 5:return o=r.sent,r.abrupt("break",11);case 7:return r.next=9,e.Secp256k1KeyPair.from({publicKeyJwk:n,privateKeyJwk:n});case 9:return o=r.sent,r.abrupt("break",11);case 11:if(o){r.next=13;break}throw new Error("Unsupported crv "+n.crv);case 13:return a=o.signer(),r.abrupt("return",{sign:function(r){return a.sign({data:r})}});case 15:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),d=function(){var r=c(f.mark((function r(t,e,n){var o,u,c;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=a.encode(i(n)),u=a.encode(i(e)),c=o+"."+u,r.next=5,t.sign(Buffer.from(c));case 5:return r.abrupt("return",c+"."+a.encode(Buffer.from(r.sent)));case 7:case"end":return r.stop()}}),r)})));return function(t,e,n){return r.apply(this,arguments)}}(),y=function(){var r=c(f.mark((function r(t){var e,n;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,v(t);case 2:return e=r.sent,n=h[t.crv],r.abrupt("return",{sign:function(){var r=c(f.mark((function r(t){return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",d(e,t,{alg:n}));case 1:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()});case 5:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),m=function(){var r=c(f.mark((function r(n){var o,a;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.crv,r.next="Ed25519"===r.t0?3:"secp256k1"===r.t0?7:11;break;case 3:return r.next=5,t.Ed25519KeyPair.from({publicKeyJwk:n});case 5:return o=r.sent,r.abrupt("break",11);case 7:return r.next=9,e.Secp256k1KeyPair.from({publicKeyJwk:n});case 9:return o=r.sent,r.abrupt("break",11);case 11:if(o){r.next=13;break}throw new Error("Unsupported crv "+n.crv);case 13:return a=o.verifier(),r.abrupt("return",{verify:function(r,t){return a.verify({data:r,signature:t})}});case 15:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),w=function(){var r=c(f.mark((function r(t,e){var n,o,i;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.split("."),o=n[2],i=n[0]+"."+n[1],r.next=4,t.verify(Buffer.from(i),a.toBuffer(o));case 4:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}(),g=function(){var r=c(f.mark((function r(t){var e;return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m(t);case 2:return e=r.sent,r.abrupt("return",{verify:function(){var r=c(f.mark((function r(t){return f.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",w(e,t));case 1:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()});case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}();exports.ed25519=t,exports.secp256k1=e,exports.createJwsSigner=y,exports.createJwsVerifier=g,exports.generateMnemonic=p,exports.toKeyPair=l;
//# sourceMappingURL=crypto.cjs.production.min.js.map
